syntax = "proto3";

option go_package = "pkg/auth";

package spvault;

service Authenticator {
  rpc Authenticate (AuthRequest) returns (AuthReply) {}
}

message AuthRequest {
  string site_url = 1;
  Strategy strategy = 2;
  string credentials = 3;
}

message AuthReply {
  string token = 1;
  TokenType token_type = 2;
  int64 expiration = 3;
}

enum Strategy {
  addin = 0;
  adfs = 1;
  fba = 2;
  saml = 3;
  tmg = 4;
}

enum TokenType {
  Bearer = 0;
  Cookie = 1;
  Custom = 3;
}